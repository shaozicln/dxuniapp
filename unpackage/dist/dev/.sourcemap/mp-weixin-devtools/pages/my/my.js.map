{"version":3,"names":["_regeneratorRuntime2","require","_asyncToGenerator2","common_vendor","src_utils_navigate_navigate","_sfc_main","defineComponent","__name","setup","__props","userInfo","reactive","avatarUrl","name","ref","messageList","id","title","content","unread","onMounted","storedUserInfo","index","getStorageSync","__f__","err","handleItemTap","item","findIndex","msg","cancelUnread","deleteMessage","splice","handleLongPress","currentItem","showActionSheet","itemList","success","res","tapIndex","fail","goToProfile","_ref","mark","_callee","wrap","_callee$","_context","prev","next","navigateToWithLoading","loadingText","onError","showToast","icon","t0","stop","apply","arguments","_ctx","_cache","e","a","b","t","c","o","d","length","f","i0","$event","g","h","i","MiniProgramPage","_export_sfc","wx","createPage"],"sources":["pages/my/my.js"],"sourcesContent":["\"use strict\";\nconst common_vendor = require(\"../../common/vendor.js\");\nconst src_utils_navigate_navigate = require(\"../../src/utils/navigate/navigate.js\");\nconst _sfc_main = /* @__PURE__ */ common_vendor.defineComponent({\n  __name: \"my\",\n  setup(__props) {\n    const userInfo = common_vendor.reactive({\n      avatarUrl: \"/static/default-avatar.png\",\n      // 头像默认图\n      name: \"未登录\"\n      // 姓名默认值（未读取到存储时显示）\n    });\n    ref(\"未登录\");\n    const messageList = common_vendor.reactive([\n      { id: 1, title: \"系统通知\", content: \"新系统通知...\", unread: true },\n      { id: 2, title: \"互动消息\", content: \"学生发来的未读消息\", unread: true },\n      { id: 3, title: \"测试消息\", content: \"未读测试\", unread: true }\n    ]);\n    common_vendor.onMounted(() => {\n      try {\n        const storedUserInfo = common_vendor.index.getStorageSync(\"userInfo\");\n        if (storedUserInfo && storedUserInfo.name) {\n          userInfo.name = storedUserInfo.name;\n          if (storedUserInfo.avatarUrl) {\n            userInfo.avatarUrl = storedUserInfo.avatarUrl;\n          }\n          common_vendor.index.__f__(\"log\", \"at pages/my/my.vue:100\", \"读取本地用户信息成功:\", userInfo);\n        } else {\n          common_vendor.index.__f__(\"warn\", \"at pages/my/my.vue:102\", \"本地未存储用户信息或信息不完整，显示默认值\");\n        }\n      } catch (err) {\n        common_vendor.index.__f__(\"error\", \"at pages/my/my.vue:105\", \"读取本地用户信息失败:\", err);\n      }\n    });\n    const handleItemTap = (item) => {\n      common_vendor.index.__f__(\"log\", \"at pages/my/my.vue:110\", \"点击消息:\", item);\n      if (item.unread) {\n        const index = messageList.findIndex((msg) => msg.id === item.id);\n        if (index !== -1)\n          messageList[index].unread = false;\n      }\n    };\n    const cancelUnread = (index) => {\n      messageList[index].unread = false;\n    };\n    const deleteMessage = (index) => {\n      messageList.splice(index, 1);\n    };\n    const handleLongPress = (index) => {\n      const currentItem = messageList[index];\n      if (currentItem.unread)\n        return;\n      common_vendor.index.showActionSheet({\n        itemList: [\"恢复标红\", \"删除\", \"取消\"],\n        success: (res) => {\n          if (res.tapIndex === 0) {\n            currentItem.unread = true;\n          } else if (res.tapIndex === 1) {\n            deleteMessage(index);\n          }\n        },\n        fail: (err) => {\n          common_vendor.index.__f__(\"warn\", \"at pages/my/my.vue:139\", \"长按菜单调用失败:\", err);\n        }\n      });\n    };\n    const goToProfile = async () => {\n      try {\n        await src_utils_navigate_navigate.navigateToWithLoading(\"/pages/personalMsg/personalMsg\", {\n          loadingText: \"加载中...\",\n          onError: (err) => {\n            common_vendor.index.__f__(\"warn\", \"at pages/my/my.vue:149\", \"跳转异常:\", err);\n            common_vendor.index.showToast({ title: \"跳转失败\", icon: \"none\" });\n          }\n        });\n      } catch (err) {\n        common_vendor.index.__f__(\"error\", \"at pages/my/my.vue:154\", \"跳转个人信息页失败:\", err);\n        common_vendor.index.showToast({ title: \"跳转失败\", icon: \"none\" });\n      }\n    };\n    return (_ctx, _cache) => {\n      return common_vendor.e({\n        a: userInfo.avatarUrl,\n        b: common_vendor.t(userInfo.name),\n        c: common_vendor.o(goToProfile),\n        d: messageList.length === 0\n      }, messageList.length === 0 ? {} : {\n        e: common_vendor.f(messageList, (item, index, i0) => {\n          return common_vendor.e({\n            a: common_vendor.t(item.title),\n            b: common_vendor.t(item.content),\n            c: item.unread\n          }, item.unread ? {\n            d: common_vendor.o(($event) => cancelUnread(index), item.id),\n            e: common_vendor.o(($event) => deleteMessage(index), item.id)\n          } : {}, {\n            f: item.unread ? 1 : \"\",\n            g: common_vendor.o(($event) => handleItemTap(item), item.id),\n            h: common_vendor.o(($event) => handleLongPress(index), item.id),\n            i: item.id\n          });\n        })\n      });\n    };\n  }\n});\nconst MiniProgramPage = /* @__PURE__ */ common_vendor._export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-2f1ef635\"]]);\nwx.createPage(MiniProgramPage);\n//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/my/my.js.map\n"],"mappings":"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"}