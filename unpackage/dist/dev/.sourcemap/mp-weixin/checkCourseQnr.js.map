{"version":3,"file":"checkCourseQnr.js","sources":["pages/questionnaire/checkCourseQnr.vue"],"sourcesContent":["<template>\n\t<view class=\"check-course-container\">\n\t\t<!-- 顶部标题栏 -->\n\t\t<view class=\"header\">\n\t\t\t<view class=\"title\">{{ currentCollege ? currentCollege : '选择学院' }}</view>\n\t\t\t<view class=\"back-btn\" @click=\"handleBack\" v-if=\"currentCollege\">返回</view>\n\t\t</view>\n\n\t\t<!-- 学院列表区域 (未选择学院时显示) -->\n\t\t<view class=\"college-list\" v-if=\"!currentCollege\">\n\t\t\t<view class=\"college-card\" v-for=\"college in filteredColleges\" :key=\"college\"\n\t\t\t\t@click=\"handleCollegeClick(college)\">\n\t\t\t\t<view class=\"college-name\">{{ college }}</view>\n\t\t\t\t<view class=\"course-count\">包含 {{ getCourseCountByCollege(college) }} 门课程</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 课程列表区域 (选择学院后显示) -->\n\t\t<view class=\"course-list\" v-if=\"currentCollege\">\n\t\t\t<view class=\"course-card\" v-for=\"course in filteredCourses\" :key=\"course.id\"\n\t\t\t\t@click=\"handleCourseClick(course)\">\n\t\t\t\t<view class=\"course-name\">{{ course.courseName }}</view>\n\t\t\t\t<view class=\"teacher-name\">-- {{ course.teacherName }}</view>\n\n\t\t\t\t<view class=\"more-btn\" @click.stop=\"showDetail(course)\">\n\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 详情弹窗 -->\n\t\t<view v-if=\"currentDetail\" class=\"detail-modal\">\n\t\t\t<view class=\"detail-content\">\n\t\t\t\t<view class=\"detail-title\">{{ currentDetail.courseName }}</view>\n\t\t\t\t<view class=\"detail-item\">课程号：{{ currentDetail.courseNo }}</view>\n\t\t\t\t<view class=\"detail-item\">课序号：{{ currentDetail.classSerial }}</view>\n\t\t\t\t<view class=\"detail-item\">学院：{{ currentDetail.courseCollege }}</view>\n\t\t\t\t<view class=\"detail-item\">类型：{{ currentDetail.courseType }}</view>\n\t\t\t\t<view class=\"detail-item\">学期：{{ currentDetail.academicTerm }}</view>\n\t\t\t\t<view class=\"detail-close\" @click=\"currentDetail = null\">关闭</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\r\n\t</template>\n\n\t<script setup>\n\timport {\n\t\tref,\n\t\tonMounted,\n\t\tcomputed\n\t} from 'vue';\n\timport {\n\t\tget\n\t} from '@/utils/request/request.js'\n\n\t// 接收关闭事件\n\tconst emit = defineEmits(['close', 'selectCourse']);\n\n\t// 课程数据\n\tconst courses = ref([]);\n\tconst loading = ref(false);\n\tconst error = ref('');\n\n\t// 学院相关状态\n\tconst currentCollege = ref(''); // 当前选中的学院\n\tconst allColleges = computed(() => {\n\t\t// 获取所有不重复的学院\n\t\tconst colleges = new Set();\n\t\tcourses.value.forEach(course => {\n\t\t\tif (course.courseCollege) {\n\t\t\t\tcolleges.add(course.courseCollege);\n\t\t\t}\n\t\t});\n\t\treturn Array.from(colleges);\n\t});\n\n\t// 筛选相关\n\tconst showFilter = ref(false);\n\tconst filterText = ref('');\n\tconst filteredColleges = computed(() => {\n\t\tif (!filterText.value) return allColleges.value;\n\t\treturn allColleges.value.filter(college =>\n\t\t\tcollege.includes(filterText.value)\n\t\t);\n\t});\n\n\t// 根据当前学院筛选课程\n\tconst filteredCourses = computed(() => {\n\t\tif (!currentCollege.value) return [];\n\t\treturn courses.value.filter(course => course.courseCollege === currentCollege.value);\n\t});\n\n\t// 详情相关\n\tconst currentDetail = ref(null);\n\n\t// 初始化加载课程数据\n\tonMounted(() => {\n\t\tfetchCourses();\n\t});\n\n\tconst fetchCourses = async () => {\n\t\ttry {\n\t\t\tloading.value = true;\n\t\t\terror.value = '';\n\t\t\t\r\n\t\t\tconsole.log('开始请求课程数据')\n\t\t\tconst res = await get('/teaching_info/classInfo/list');\r\n\t\t\tconsole.log('请求返回结果:', res);\n\n\t\t\tif (res.code === 200) {\n\t\t\t\tcourses.value = res.rows || [];\n\t\t\t\tconsole.log('获取课程成功，数据长度:', res.rows?.length || 0);\n\t\t\t} else {\n\t\t\t\terror.value = `获取失败: ${res.msg || '未知错误'}`;\n\t\t\t}\n\n\t\t} catch (err) {\n\t\t\terror.value = '网络错误，请检查接口是否可用';\n\t\t\tconsole.error('请求异常:', err);\n\t\t} finally {\n\t\t\tloading.value = false;\n\t\t}\n\t};\n\n\t// 计算某个学院的课程数量\n\tconst getCourseCountByCollege = (college) => {\n\t\treturn courses.value.filter(course => course.courseCollege === college).length;\n\t};\n\n\t// 学院点击事件\n\tconst handleCollegeClick = (college) => {\n\t\tcurrentCollege.value = college;\n\t};\n\n\t// 返回按钮事件（从课程列表返回学院列表）\n\tconst handleBack = () => {\n\t\tcurrentCollege.value = '';\n\t};\n\n\t// 课程点击事件\n\tconst handleCourseClick = (course) => {\n\t\temit('selectCourse', course.courseNo, course.classSerial);\n\t};\n\n\t// 显示详情\n\tconst showDetail = (course) => {\n\t\tcurrentDetail.value = { ...course };\n\t};\n\t</script>\n\n\t<style scoped>\n\t.check-course-container {\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t/* 头部样式 */\n\t.header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 25rpx 30rpx;\n\t\tborder-bottom: 1rpx solid #eee;\n\t}\n\n\t.title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: 500;\n\t\tcolor: #333;\n\t}\n\n\t.filter-btn, .back-btn {\n\t\tfont-size: 28rpx;\n\t\tcolor: #42b983;\n\t\tpadding: 10rpx 20rpx;\n\t}\n\n\t/* 学院列表 */\n\t.college-list {\n\t\tflex: 1;\n\t\toverflow-y: auto;\n\t\tpadding: 20rpx;\n\t}\n\n\t.college-card {\n\t\tbackground-color: #f9f9f9;\n\t\tborder-radius: 16rpx;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\t.college-name {\n\t\tfont-size: 32rpx;\n\t\tcolor: #333;\n\t}\n\n\t.course-count {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t\tmargin-top: 10rpx;\n\t}\n\n\t/* 课程列表 */\n\t.course-list {\n\t\tflex: 1;\n\t\toverflow-y: auto;\n\t\tpadding: 20rpx;\n\t}\n\n\t.course-card {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tbackground-color: #f9f9f9;\n\t\tborder-radius: 16rpx;\n\t\tpadding: 25rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tposition: relative;\n\t}\n\n\t.course-name {\n\t\tfont-size: 30rpx;\n\t\tcolor: #333;\n\t}\n\n\t.teacher-name {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t\tmargin-top: 5rpx;\n\t}\n\n\t/* 右侧三点按钮 */\n\t.more-btn {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 60rpx;\n\t\theight: 100%;\n\t}\n\n\t.dot {\n\t\twidth: 8rpx;\n\t\theight: 8rpx;\n\t\tbackground-color: #999;\n\t\tborder-radius: 50%;\n\t\tmargin: 5rpx 0;\n\t}\n\n\t/* 详情弹窗 */\n\t.detail-modal {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tz-index: 100;\n\t}\n\n\t.detail-content {\n\t\twidth: 80%;\n\t\tbackground-color: white;\n\t\tborder-radius: 20rpx;\n\t\tpadding: 30rpx;\n\t}\n\n\t.detail-title {\n\t\tfont-size: 34rpx;\n\t\tfont-weight: 500;\n\t\ttext-align: center;\n\t\tmargin-bottom: 30rpx;\n\t}\n\n\t.detail-item {\n\t\tfont-size: 28rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tcolor: #555;\n\t}\n\n\t.detail-close {\n\t\ttext-align: center;\n\t\tmargin-top: 30rpx;\n\t\tcolor: #42b983;\n\t\tfont-size: 30rpx;\n\t\tpadding: 15rpx 0;\n\t\tborder-top: 1rpx solid #eee;\n\t}\n\t</style>"],"names":["ref","computed","onMounted","uni","get"],"mappings":";;;;;;;AA0DC,UAAM,OAAO;AAGb,UAAM,UAAUA,kBAAI,CAAA,CAAE;AACtB,UAAM,UAAUA,kBAAI,KAAK;AACzB,UAAM,QAAQA,kBAAI,EAAE;AAGpB,UAAM,iBAAiBA,kBAAI,EAAE;AAC7B,UAAM,cAAcC,cAAAA,SAAS,MAAM;AAElC,YAAM,WAAW,oBAAI;AACrB,cAAQ,MAAM,QAAQ,YAAU;AAC/B,YAAI,OAAO,eAAe;AACzB,mBAAS,IAAI,OAAO,aAAa;AAAA,QACjC;AAAA,MACJ,CAAG;AACD,aAAO,MAAM,KAAK,QAAQ;AAAA,IAC5B,CAAE;AAGkBD,kBAAAA,IAAI,KAAK;AAC5B,UAAM,aAAaA,kBAAI,EAAE;AACzB,UAAM,mBAAmBC,cAAAA,SAAS,MAAM;AACvC,UAAI,CAAC,WAAW;AAAO,eAAO,YAAY;AAC1C,aAAO,YAAY,MAAM;AAAA,QAAO,aAC/B,QAAQ,SAAS,WAAW,KAAK;AAAA,MACpC;AAAA,IACA,CAAE;AAGD,UAAM,kBAAkBA,cAAAA,SAAS,MAAM;AACtC,UAAI,CAAC,eAAe;AAAO,eAAO;AAClC,aAAO,QAAQ,MAAM,OAAO,YAAU,OAAO,kBAAkB,eAAe,KAAK;AAAA,IACrF,CAAE;AAGD,UAAM,gBAAgBD,kBAAI,IAAI;AAG9BE,kBAAAA,UAAU,MAAM;AACf;IACF,CAAE;AAED,UAAM,eAAe,YAAY;;AAChC,UAAI;AACH,gBAAQ,QAAQ;AAChB,cAAM,QAAQ;AAEdC,sBAAAA,MAAY,MAAA,OAAA,iDAAA,UAAU;AACtB,cAAM,MAAM,MAAMC,0BAAI,+BAA+B;AACrDD,sBAAA,MAAA,MAAA,OAAA,iDAAY,WAAW,GAAG;AAE1B,YAAI,IAAI,SAAS,KAAK;AACrB,kBAAQ,QAAQ,IAAI,QAAQ,CAAA;AAC5BA,4FAAY,kBAAgB,SAAI,SAAJ,mBAAU,WAAU,CAAC;AAAA,QACrD,OAAU;AACN,gBAAM,QAAQ,SAAS,IAAI,OAAO,MAAM;AAAA,QACxC;AAAA,MAED,SAAQ,KAAK;AACb,cAAM,QAAQ;AACdA,sBAAA,MAAA,MAAA,SAAA,iDAAc,SAAS,GAAG;AAAA,MAC7B,UAAY;AACT,gBAAQ,QAAQ;AAAA,MAChB;AAAA,IACH;AAGC,UAAM,0BAA0B,CAAC,YAAY;AAC5C,aAAO,QAAQ,MAAM,OAAO,YAAU,OAAO,kBAAkB,OAAO,EAAE;AAAA,IAC1E;AAGC,UAAM,qBAAqB,CAAC,YAAY;AACvC,qBAAe,QAAQ;AAAA,IACzB;AAGC,UAAM,aAAa,MAAM;AACxB,qBAAe,QAAQ;AAAA,IACzB;AAGC,UAAM,oBAAoB,CAAC,WAAW;AACrC,WAAK,gBAAgB,OAAO,UAAU,OAAO,WAAW;AAAA,IAC1D;AAGC,UAAM,aAAa,CAAC,WAAW;AAC9B,oBAAc,QAAQ,EAAE,GAAG;IAC7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}