{"version":3,"file":"checkCourseQnr.js","sources":["pages/questionnaire/checkCourseQnr.vue"],"sourcesContent":["<template>\r\n\t<view class=\"check-course-container\">\r\n\t\t<!-- 顶部标题栏 -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"title\">{{ currentCollege ? currentCollege : '选择学院' }}</view>\r\n\t\t\t<view class=\"back-btn\" @click=\"handleBack\" v-if=\"currentCollege\">返回</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 学院列表区域 (未选择学院时显示) -->\r\n\t\t<view class=\"college-list\" v-if=\"!currentCollege\">\r\n\t\t\t<view class=\"college-card\" v-for=\"college in filteredColleges\" :key=\"college\"\r\n\t\t\t\t@click=\"handleCollegeClick(college)\">\r\n\t\t\t\t<view class=\"college-name\">{{ college }}</view>\r\n\t\t\t\t<view class=\"course-count\">包含 {{ getCourseCountByCollege(college) }} 门课程</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 课程列表区域 (选择学院后显示) -->\r\n\t\t<view class=\"course-list\" v-if=\"currentCollege\">\r\n\t\t\t<view class=\"course-card\" v-for=\"course in filteredCourses\" :key=\"course.id\"\r\n\t\t\t\t@click=\"handleCourseClick(course)\">\r\n\t\t\t\t<view class=\"course-name\">{{ course.courseName }}</view>\r\n\t\t\t\t<view class=\"teacher-name\">-- {{ course.teacherName }}</view>\r\n\r\n\t\t\t\t<view class=\"more-btn\" @click.stop=\"showDetail(course)\">\r\n\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 详情弹窗 -->\r\n\t\t<view v-if=\"currentDetail\" class=\"detail-modal\">\r\n\t\t\t<view class=\"detail-content\">\r\n\t\t\t\t<view class=\"detail-title\">{{ currentDetail.courseName }}</view>\r\n\t\t\t\t<view class=\"detail-item\">课程号：{{ currentDetail.courseNo }}</view>\r\n\t\t\t\t<view class=\"detail-item\">课序号：{{ currentDetail.classSerial }}</view>\r\n\t\t\t\t<view class=\"detail-item\">学院：{{ currentDetail.courseCollege }}</view>\r\n\t\t\t\t<view class=\"detail-item\">类型：{{ currentDetail.courseType }}</view>\r\n\t\t\t\t<view class=\"detail-item\">学期：{{ currentDetail.academicTerm }}</view>\r\n\t\t\t\t<view class=\"detail-close\" @click=\"currentDetail = null\">关闭</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\t</template>\r\n\r\n\t<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted,\r\n\t\tcomputed\r\n\t} from 'vue';\r\n\timport {\r\n\t\tget\r\n\t} from '@/utils/request/request.js'\r\n\r\n\t// 接收关闭事件\r\n\tconst emit = defineEmits(['close', 'selectCourse']);\r\n\r\n\t// 课程数据\r\n\tconst courses = ref([]);\r\n\tconst loading = ref(false);\r\n\tconst error = ref('');\r\n\r\n\t// 学院相关状态\r\n\tconst currentCollege = ref(''); // 当前选中的学院\r\n\tconst allColleges = computed(() => {\r\n\t\t// 获取所有不重复的学院\r\n\t\tconst colleges = new Set();\r\n\t\tcourses.value.forEach(course => {\r\n\t\t\tif (course.courseCollege) {\r\n\t\t\t\tcolleges.add(course.courseCollege);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Array.from(colleges);\r\n\t});\r\n\r\n\t// 筛选相关\r\n\tconst showFilter = ref(false);\r\n\tconst filterText = ref('');\r\n\tconst filteredColleges = computed(() => {\r\n\t\tif (!filterText.value) return allColleges.value;\r\n\t\treturn allColleges.value.filter(college =>\r\n\t\t\tcollege.includes(filterText.value)\r\n\t\t);\r\n\t});\r\n\r\n\t// 根据当前学院筛选课程\r\n\tconst filteredCourses = computed(() => {\r\n\t\tif (!currentCollege.value) return [];\r\n\t\treturn courses.value.filter(course => course.courseCollege === currentCollege.value);\r\n\t});\r\n\r\n\t// 详情相关\r\n\tconst currentDetail = ref(null);\r\n\r\n\t// 初始化加载课程数据\r\n\tonMounted(() => {\r\n\t\tfetchCourses();\r\n\t});\r\n\r\n\tconst fetchCourses = async () => {\r\n\t\ttry {\r\n\t\t\tloading.value = true;\r\n\t\t\terror.value = '';\r\n\t\t\t\r\n\t\t\tconsole.log('开始请求课程数据')\r\n\t\t\tconst res = await get('/teaching_info/classInfo/list');\r\n\t\t\tconsole.log('请求返回结果:', res);\r\n\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\tcourses.value = res.rows || [];\r\n\t\t\t\tconsole.log('获取课程成功，数据长度:', res.rows?.length || 0);\r\n\t\t\t} else {\r\n\t\t\t\terror.value = `获取失败: ${res.msg || '未知错误'}`;\r\n\t\t\t}\r\n\r\n\t\t} catch (err) {\r\n\t\t\terror.value = '网络错误，请检查接口是否可用';\r\n\t\t\tconsole.error('请求异常:', err);\r\n\t\t} finally {\r\n\t\t\tloading.value = false;\r\n\t\t}\r\n\t};\r\n\r\n\t// 计算某个学院的课程数量\r\n\tconst getCourseCountByCollege = (college) => {\r\n\t\treturn courses.value.filter(course => course.courseCollege === college).length;\r\n\t};\r\n\r\n\t// 学院点击事件\r\n\tconst handleCollegeClick = (college) => {\r\n\t\tcurrentCollege.value = college;\r\n\t};\r\n\r\n\t// 返回按钮事件（从课程列表返回学院列表）\r\n\tconst handleBack = () => {\r\n\t\tcurrentCollege.value = '';\r\n\t};\r\n\r\n\t// 课程点击事件\r\n\tconst handleCourseClick = (course) => {\r\n\t\temit('selectCourse', course.courseNo, course.classSerial);\r\n\t};\r\n\r\n\t// 显示详情\r\n\tconst showDetail = (course) => {\r\n\t\tcurrentDetail.value = { ...course };\r\n\t};\r\n\t</script>\r\n\r\n\t<style scoped>\r\n\t.check-course-container {\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t/* 头部样式 */\r\n\t.header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 25rpx 30rpx;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.filter-btn, .back-btn {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #42b983;\r\n\t\tpadding: 10rpx 20rpx;\r\n\t}\r\n\r\n\t/* 学院列表 */\r\n\t.college-list {\r\n\t\tflex: 1;\r\n\t\toverflow-y: auto;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\r\n\t.college-card {\r\n\t\tbackground-color: #f9f9f9;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.college-name {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.course-count {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-top: 10rpx;\r\n\t}\r\n\r\n\t/* 课程列表 */\r\n\t.course-list {\r\n\t\tflex: 1;\r\n\t\toverflow-y: auto;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\r\n\t.course-card {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #f9f9f9;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 25rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.course-name {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.teacher-name {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-top: 5rpx;\r\n\t}\r\n\r\n\t/* 右侧三点按钮 */\r\n\t.more-btn {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 60rpx;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.dot {\r\n\t\twidth: 8rpx;\r\n\t\theight: 8rpx;\r\n\t\tbackground-color: #999;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin: 5rpx 0;\r\n\t}\r\n\r\n\t/* 详情弹窗 */\r\n\t.detail-modal {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 100;\r\n\t}\r\n\r\n\t.detail-content {\r\n\t\twidth: 80%;\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 30rpx;\r\n\t}\r\n\r\n\t.detail-title {\r\n\t\tfont-size: 34rpx;\r\n\t\tfont-weight: 500;\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.detail-item {\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tcolor: #555;\r\n\t}\r\n\r\n\t.detail-close {\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 30rpx;\r\n\t\tcolor: #42b983;\r\n\t\tfont-size: 30rpx;\r\n\t\tpadding: 15rpx 0;\r\n\t\tborder-top: 1rpx solid #eee;\r\n\t}\r\n\t</style>"],"names":["ref","computed","onMounted","uni","get"],"mappings":";;;;;;;AA0DC,UAAM,OAAO;AAGb,UAAM,UAAUA,kBAAI,CAAA,CAAE;AACtB,UAAM,UAAUA,kBAAI,KAAK;AACzB,UAAM,QAAQA,kBAAI,EAAE;AAGpB,UAAM,iBAAiBA,kBAAI,EAAE;AAC7B,UAAM,cAAcC,cAAAA,SAAS,MAAM;AAElC,YAAM,WAAW,oBAAI;AACrB,cAAQ,MAAM,QAAQ,YAAU;AAC/B,YAAI,OAAO,eAAe;AACzB,mBAAS,IAAI,OAAO,aAAa;AAAA,QACjC;AAAA,MACJ,CAAG;AACD,aAAO,MAAM,KAAK,QAAQ;AAAA,IAC5B,CAAE;AAGkBD,kBAAAA,IAAI,KAAK;AAC5B,UAAM,aAAaA,kBAAI,EAAE;AACzB,UAAM,mBAAmBC,cAAAA,SAAS,MAAM;AACvC,UAAI,CAAC,WAAW;AAAO,eAAO,YAAY;AAC1C,aAAO,YAAY,MAAM;AAAA,QAAO,aAC/B,QAAQ,SAAS,WAAW,KAAK;AAAA,MACpC;AAAA,IACA,CAAE;AAGD,UAAM,kBAAkBA,cAAAA,SAAS,MAAM;AACtC,UAAI,CAAC,eAAe;AAAO,eAAO;AAClC,aAAO,QAAQ,MAAM,OAAO,YAAU,OAAO,kBAAkB,eAAe,KAAK;AAAA,IACrF,CAAE;AAGD,UAAM,gBAAgBD,kBAAI,IAAI;AAG9BE,kBAAAA,UAAU,MAAM;AACf;IACF,CAAE;AAED,UAAM,eAAe,YAAY;;AAChC,UAAI;AACH,gBAAQ,QAAQ;AAChB,cAAM,QAAQ;AAEdC,sBAAAA,MAAY,MAAA,OAAA,iDAAA,UAAU;AACtB,cAAM,MAAM,MAAMC,0BAAI,+BAA+B;AACrDD,sBAAA,MAAA,MAAA,OAAA,iDAAY,WAAW,GAAG;AAE1B,YAAI,IAAI,SAAS,KAAK;AACrB,kBAAQ,QAAQ,IAAI,QAAQ,CAAA;AAC5BA,4FAAY,kBAAgB,SAAI,SAAJ,mBAAU,WAAU,CAAC;AAAA,QACrD,OAAU;AACN,gBAAM,QAAQ,SAAS,IAAI,OAAO,MAAM;AAAA,QACxC;AAAA,MAED,SAAQ,KAAK;AACb,cAAM,QAAQ;AACdA,sBAAA,MAAA,MAAA,SAAA,iDAAc,SAAS,GAAG;AAAA,MAC7B,UAAY;AACT,gBAAQ,QAAQ;AAAA,MAChB;AAAA,IACH;AAGC,UAAM,0BAA0B,CAAC,YAAY;AAC5C,aAAO,QAAQ,MAAM,OAAO,YAAU,OAAO,kBAAkB,OAAO,EAAE;AAAA,IAC1E;AAGC,UAAM,qBAAqB,CAAC,YAAY;AACvC,qBAAe,QAAQ;AAAA,IACzB;AAGC,UAAM,aAAa,MAAM;AACxB,qBAAe,QAAQ;AAAA,IACzB;AAGC,UAAM,oBAAoB,CAAC,WAAW;AACrC,WAAK,gBAAgB,OAAO,UAAU,OAAO,WAAW;AAAA,IAC1D;AAGC,UAAM,aAAa,CAAC,WAAW;AAC9B,oBAAc,QAAQ,EAAE,GAAG;IAC7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}