{"version":3,"file":"my.js","sources":["src/pages/my/my.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3JjL3BhZ2VzL215L215LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"my-container\">\n    <!-- 个人信息区域，绑定点击跳转事件 -->\n    <view class=\"profile-section\" @tap=\"goToProfile\"> \n      <image \n        class=\"avatar\" \n        :src=\"userInfo.avatarUrl\" \n        mode=\"aspectFill\"\n        lazy-load \n      ></image>\n      <view class=\"user-info-wrapper\">\n        <view class=\"user-info\">\n          <text class=\"nickname\">{{ userInfo.nickname }}</text>\n          <text class=\"desc\">用户身份</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 消息列表区域 -->\n    <view class=\"message-section\">\n      <view class=\"section-title\">消息列表</view>\n      <!-- 新增：空列表提示 -->\n      <view v-if=\"messageList.length === 0\" class=\"empty-tip\">暂无消息</view>\n      <template v-else v-for=\"(item, index) in messageList\" :key=\"item.id\"> \n        <view \n          class=\"message-item\" \n          :class=\"{ unread: item.unread }\"\n          @tap=\"handleItemTap(item)\"\n          @longpress=\"handleLongPress(index)\"\n        >\n          <text class=\"message-title\">{{ item.title }}</text>\n          <text class=\"message-content\">{{ item.content }}</text>\n          <view class=\"action-buttons\" v-if=\"item.unread\">\n            <button \n              class=\"btn cancel-unread\" \n              size=\"mini\" \n              @tap.stop=\"cancelUnread(index)\"\n            >\n              取消标红\n            </button>\n            <button \n              class=\"btn delete-msg\" \n              size=\"mini\" \n              @tap.stop=\"deleteMessage(index)\"\n            >\n              删除\n            </button>\n          </view>\n        </view>\n      </template>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"ts\">\nimport { reactive } from 'vue';\r\n//改成绝对路径了\nimport { navigateToWithLoading } from '../../utils/navigate/navigate'; \n\n// 类型定义集中管理\ninterface UserInfo {\n  avatarUrl: string;\n  nickname: string;\n}\n\ninterface MessageItem {\n  id: number;\n  title: string;\n  content: string;\n  unread: boolean;\n}\n\n// 响应式数据\nconst userInfo = reactive<UserInfo>({\n  avatarUrl: '/static/default-avatar.png', \n  nickname: '用户姓名' \n});\n\nconst messageList = reactive<MessageItem[]>([\n  { id: 1, title: '系统通知', content: '新系统通知...', unread: true },\n  { id: 2, title: '互动消息', content: '学生发来的未读消息', unread: true }, \n  { id: 3, title: '测试消息', content: '未读测试', unread: true }\n]);\nconst handleItemTap = (item: MessageItem) => {\n  uni.__f__('log','at src/pages/my/my.vue:85','点击消息:', item);\n  if (item.unread) {\n    const index = messageList.findIndex(msg => msg.id === item.id);\n    if (index !== -1) messageList[index].unread = false;\n  }\n  // 可扩展：跳转到消息详情页\n  // navigateToWithLoading(`/pages/messageDetail/messageDetail?id=${item.id}`);\n};\n\nconst cancelUnread = (index: number) => {\n  messageList[index].unread = false;\n};\n\nconst deleteMessage = (index: number) => {\n  messageList.splice(index, 1);\n \n};\n\nconst handleLongPress = (index: number) => {\n  const currentItem = messageList[index];\n  if (currentItem.unread) return; \n\n  uni.showActionSheet({\n    itemList: ['恢复标红', '删除', '取消'],\n    success: (res) => {\n      if (res.tapIndex === 0) {\n        currentItem.unread = true; \n      } else if (res.tapIndex === 1) {\n        deleteMessage(index);\n      }\n    },\n    fail: (err) => {\n      uni.__f__('warn','at src/pages/my/my.vue:117','长按菜单调用失败:', err);\n    }\n  });\n};\n\nconst goToProfile = async () => {\n  try {\n    await navigateToWithLoading('./src/pages/personalMsg/personalMsg', {\n      loadingText: '加载中...',\n      onError: (err) => {\n        uni.__f__('warn','at src/pages/my/my.vue:127','跳转异常:', err);\n        uni.showToast({ title: '跳转失败', icon: 'none' }); // 新增：用户可见的错误提示\n      }\n    });\n  } catch (err) {\n    uni.__f__('error','at src/pages/my/my.vue:132','跳转个人信息页失败:', err);\n    uni.showToast({ title: '跳转失败', icon: 'none' });\n  }\n};\n</script>\n\n<style scoped>\n\n.my-container {\n  display: flex;\n  flex-direction: column;\n  background-color: #f8fef8; \n  min-height: 100vh;\n}\n\n/* 个人信息区域 */\n.profile-section {\n  position: relative;\n  width: 100%;\n  height: 30vh;\n  background: linear-gradient(to bottom, #c9edf5, #f8fef8); \n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0 40rpx;\n  box-sizing: border-box;\n  margin-bottom: 0;\n}\n\n/* 头像样式 */\n.avatar {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 50%;\n  border: 3rpx solid #c9edf5; \n  margin-right: 20rpx; \n  object-fit: cover;\n}\n\n/* 用户信息包裹层 */\n.user-info-wrapper {\n  flex: 1;\n  display: flex;\n  justify-content: flex-start; \n  align-items: center;\n}\n\n/* 用户信息内容 */\n.user-info {\n  display: flex;\n  flex-direction: column;\n}\n\n/* 昵称样式 */\n.nickname {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #444; \n  text-align: left; \n}\n\n/* 描述文本样式 */\n.desc {\n  font-size: 28rpx;\n  color: #777; \n  margin-top: 8rpx;\n  text-align: left;\n}\n\n/* 消息列表区域 */\n.message-section {\n  flex: 1;\n  padding: 20rpx 10rpx;\n  box-sizing: border-box;\n}\n\n/* 板块标题样式 */\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 20rpx;\n  border-left: 10rpx solid #90ee90; \n  padding-left: 10rpx;\n}\n\n/* 空列表提示（新增） */\n.empty-tip {\n  font-size: 28rpx;\n  color: #999;\n  text-align: center;\n  padding: 50rpx 0;\n}\n\n/* 消息项容器 */\n.message-item {\n  padding: 20rpx;\n  border-bottom: 1px solid #f0f0f0; \n  display: flex;\n  flex-direction: column;\n  transition: background-color 0.2s ease; \n  border: 1px solid #e6e6e6; \n  border-radius: 8rpx;\n  margin-bottom: 15rpx;\n  background-color: #fff;\n}\n\n/* 未读消息背景样式 */\n.unread {\n  background-color: #ffeaea; \n  border-color: #ffcccc;\n}\n\n/* 消息标题样式 */\n.message-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n/* 消息内容样式 */\n.message-content {\n  font-size: 26rpx;\n  color: #666; \n  line-height: 1.6; \n\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n/* 操作按钮容器 */\n.action-buttons {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 15rpx; \n}\n\n/* 按钮基础样式 */\n.btn {\n  margin-left: 20rpx;\n  padding: 12rpx 24rpx; \n  border-radius: 8rpx;\n  font-size: 24rpx; \n  border: none;\n}\n\n/* 取消标红按钮样式 */\n.cancel-unread {\n  background-color: #70d770; \n  color: #fff;\n}\n\n/* 删除按钮样式 */\n.delete-msg {\n  background-color: #f75757; \n  color: #fff;\n}\n\n/* 按钮点击反馈 */\n.btn:active {\n  opacity: 0.8;\n  transform: scale(0.98);\n}\n</style>","import MiniProgramPage from 'D:/小程序/HBuilderX.4.75.2025071105/dx-project/dxuniapp/src/pages/my/my.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","uni","navigateToWithLoading"],"mappings":";;;;;;AAyEA,UAAM,WAAWA,cAAAA,SAAmB;AAAA,MAClC,WAAW;AAAA,MACX,UAAU;AAAA,IAAA,CACX;AAED,UAAM,cAAcA,cAAAA,SAAwB;AAAA,MAC1C,EAAE,IAAI,GAAG,OAAO,QAAQ,SAAS,YAAY,QAAQ,KAAK;AAAA,MAC1D,EAAE,IAAI,GAAG,OAAO,QAAQ,SAAS,aAAa,QAAQ,KAAK;AAAA,MAC3D,EAAE,IAAI,GAAG,OAAO,QAAQ,SAAS,QAAQ,QAAQ,KAAK;AAAA,IAAA,CACvD;AACK,UAAA,gBAAgB,CAAC,SAAsB;AAC3CC,oBAAA,MAAI,MAAM,OAAM,6BAA4B,SAAS,IAAI;AACzD,UAAI,KAAK,QAAQ;AACf,cAAM,QAAQ,YAAY,UAAU,SAAO,IAAI,OAAO,KAAK,EAAE;AAC7D,YAAI,UAAU;AAAgB,sBAAA,KAAK,EAAE,SAAS;AAAA,MAChD;AAAA,IAAA;AAKI,UAAA,eAAe,CAAC,UAAkB;AAC1B,kBAAA,KAAK,EAAE,SAAS;AAAA,IAAA;AAGxB,UAAA,gBAAgB,CAAC,UAAkB;AAC3B,kBAAA,OAAO,OAAO,CAAC;AAAA,IAAA;AAIvB,UAAA,kBAAkB,CAAC,UAAkB;AACnC,YAAA,cAAc,YAAY,KAAK;AACrC,UAAI,YAAY;AAAQ;AAExBA,oBAAAA,MAAI,gBAAgB;AAAA,QAClB,UAAU,CAAC,QAAQ,MAAM,IAAI;AAAA,QAC7B,SAAS,CAAC,QAAQ;AACZ,cAAA,IAAI,aAAa,GAAG;AACtB,wBAAY,SAAS;AAAA,UAAA,WACZ,IAAI,aAAa,GAAG;AAC7B,0BAAc,KAAK;AAAA,UACrB;AAAA,QACF;AAAA,QACA,MAAM,CAAC,QAAQ;AACbA,wBAAA,MAAI,MAAM,QAAO,8BAA6B,aAAa,GAAG;AAAA,QAChE;AAAA,MAAA,CACD;AAAA,IAAA;AAGH,UAAM,cAAc,YAAY;AAC1B,UAAA;AACF,cAAMC,4BAAAA,sBAAsB,uCAAuC;AAAA,UACjE,aAAa;AAAA,UACb,SAAS,CAAC,QAAQ;AAChBD,0BAAA,MAAI,MAAM,QAAO,8BAA6B,SAAS,GAAG;AAC1DA,0BAAA,MAAI,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,UAC/C;AAAA,QAAA,CACD;AAAA,eACM,KAAK;AACZA,sBAAA,MAAI,MAAM,SAAQ,8BAA6B,cAAc,GAAG;AAChEA,sBAAA,MAAI,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,MAC/C;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpIF,GAAG,WAAW,eAAe;"}