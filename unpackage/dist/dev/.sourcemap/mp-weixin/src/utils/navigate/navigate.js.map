{"version":3,"file":"navigate.js","sources":["src/utils/navigate/navigate.ts"],"sourcesContent":["interface NavigateOptions {\r\n  loadingText?: string;\r\n  success?: (res: any) => void;\r\n  fail?: (err: UniApp.GeneralCallbackResult) => void;\r\n  onError?: (err: UniApp.GeneralCallbackResult) => void;\r\n}\r\n\r\nexport function navigateToWithLoading(\r\n  url: string, \r\n  options: NavigateOptions = {}\r\n): Promise<any> { \r\n  if (!url || !url.startsWith('/')) {\r\n    const err = new Error(`跳转路径不合法：${url}，需以 / 开头（如 /pages/index/index）`) as Error & { errMsg?: string };\r\n    err.errMsg = `navigateToWithLoading:fail ${err.message}`;\r\n\r\n    options.onError?.(err as UniApp.GeneralCallbackResult);\r\n    uni.showToast({ title: '路径错误', icon: 'none' });\r\n    return Promise.reject(err);\r\n  }\r\n  \r\n  uni.showLoading({\r\n    title: options.loadingText || '加载中...',\r\n    mask: true,\r\n    success: () => {},\r\n    fail: (loadErr) => {\r\n      options.onError?.(loadErr);\r\n      return Promise.reject(loadErr);\r\n    }\r\n  });\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    uni.navigateTo({\r\n      url,\r\n      success: (res) => {\r\n        uni.hideLoading();\r\n        options.success?.(res);\r\n        resolve(res);\r\n      },\r\n      fail: (err) => {\r\n        uni.hideLoading();\r\n        if (options.onError) {\r\n          options.onError(err);\r\n        } else {\r\n          const errorMap: Record<string, string> = {\r\n            'page not found': '页面不存在',\r\n            'timeout': '加载超时',\r\n            'navigateTo:fail can not navigate to tabbar page': '不能跳转到 tabbar 页面（需用 switchTab）',\r\n            'navigateTo:fail page \"xxx\" is not found': '目标页面未在 pages.json 注册'\r\n          };\r\n          const matchKey = Object.keys(errorMap).find(key => \r\n            err.errMsg.toLowerCase().includes(key.toLowerCase())\r\n          ) || 'default';\r\n          uni.showToast({\r\n            title: errorMap[matchKey] || '跳转失败',\r\n            icon: 'none',\r\n            duration: 2000\r\n          });\r\n          console.error('页面跳转失败:', err);\r\n        }\r\n        options.fail?.(err);\r\n        reject(err);\r\n      }\r\n    });\r\n  });\r\n}\r\n"],"names":["uni","_a"],"mappings":";;AAOO,SAAS,sBACd,KACA,UAA2B,IACb;;AACd,MAAI,CAAC,OAAO,CAAC,IAAI,WAAW,GAAG,GAAG;AAChC,UAAM,MAAM,IAAI,MAAM,WAAW,GAAG,gCAAgC;AAChE,QAAA,SAAS,8BAA8B,IAAI,OAAO;AAEtD,kBAAQ,YAAR,iCAAkB;AAClBA,kBAAA,MAAI,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AACtC,WAAA,QAAQ,OAAO,GAAG;AAAA,EAC3B;AAEAA,gBAAAA,MAAI,YAAY;AAAA,IACd,OAAO,QAAQ,eAAe;AAAA,IAC9B,MAAM;AAAA,IACN,SAAS,MAAM;AAAA,IAAC;AAAA,IAChB,MAAM,CAAC,YAAY;;AACjB,OAAAC,MAAA,QAAQ,YAAR,gBAAAA,IAAA,cAAkB;AACX,aAAA,QAAQ,OAAO,OAAO;AAAA,IAC/B;AAAA,EAAA,CACD;AAED,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCD,kBAAAA,MAAI,WAAW;AAAA,MACb;AAAA,MACA,SAAS,CAAC,QAAQ;;AAChBA,sBAAA,MAAI,YAAY;AAChB,SAAAC,MAAA,QAAQ,YAAR,gBAAAA,IAAA,cAAkB;AAClB,gBAAQ,GAAG;AAAA,MACb;AAAA,MACA,MAAM,CAAC,QAAQ;;AACbD,sBAAA,MAAI,YAAY;AAChB,YAAI,QAAQ,SAAS;AACnB,kBAAQ,QAAQ,GAAG;AAAA,QAAA,OACd;AACL,gBAAM,WAAmC;AAAA,YACvC,kBAAkB;AAAA,YAClB,WAAW;AAAA,YACX,mDAAmD;AAAA,YACnD,2CAA2C;AAAA,UAAA;AAE7C,gBAAM,WAAW,OAAO,KAAK,QAAQ,EAAE;AAAA,YAAK,CAAA,QAC1C,IAAI,OAAO,cAAc,SAAS,IAAI,aAAa;AAAA,UAChD,KAAA;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,SAAS,QAAQ,KAAK;AAAA,YAC7B,MAAM;AAAA,YACN,UAAU;AAAA,UAAA,CACX;AACDA,wBAAA,MAAc,MAAA,SAAA,wCAAA,WAAW,GAAG;AAAA,QAC9B;AACA,SAAAC,MAAA,QAAQ,SAAR,gBAAAA,IAAA,cAAe;AACf,eAAO,GAAG;AAAA,MACZ;AAAA,IAAA,CACD;AAAA,EAAA,CACF;AACH;;"}